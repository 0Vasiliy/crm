import{E as $e,G as Ft,H as Ht,I as W,J as Et,K as zt,L as Lt,M as Zt,N as jt,c as Y,T as Xt,Q as Kt,O as ct,P as je,g as R,x as ue,z as F,R as Q,S as mt,U as K,y as Xe,D as Ke,B as ce,C as Ge,A as We,V as vt,W as ft,X as Gt,Y as Wt,Z as Jt,$ as ea,a0 as ta,a as pe,u as ge,a1 as Be,o as Oe,a2 as re,a3 as Ye,f as H,w as f,e as a,a4 as j,a5 as A,d as v,t as U,a6 as T,a7 as Re,j as me,a8 as q,a9 as Ne,i as P,_ as Ae,aa as pt,ab as aa,h as Ve,b as se,k as la,F as na,ac as nt}from"./index-BImh0Udg.js";import{p as B,c as oa,Q as k,a as we,b as De,d as L,e as _e,f as sa,g as ra,h as Se,i as Me,j as ot}from"./QTabPanels-FxUvnMtT.js";import{Q as O}from"./QTd-DbWYxSVX.js";import{u as gt}from"./utilities-C_4KouiO.js";import{u as ye}from"./residents-aQAaffLr.js";const ia='<circle cx="15" cy="15" r="15"><animate attributeName="r" from="15" to="15" begin="0s" dur="0.8s" values="15;9;15" calcMode="linear" repeatCount="indefinite"></animate><animate attributeName="fill-opacity" from="1" to="1" begin="0s" dur="0.8s" values="1;.5;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="60" cy="15" r="9" fill-opacity=".3"><animate attributeName="r" from="9" to="9" begin="0s" dur="0.8s" values="9;15;9" calcMode="linear" repeatCount="indefinite"></animate><animate attributeName="fill-opacity" from=".5" to=".5" begin="0s" dur="0.8s" values=".5;1;.5" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="105" cy="15" r="15"><animate attributeName="r" from="15" to="15" begin="0s" dur="0.8s" values="15;9;15" calcMode="linear" repeatCount="indefinite"></animate><animate attributeName="fill-opacity" from="1" to="1" begin="0s" dur="0.8s" values="1;.5;1" calcMode="linear" repeatCount="indefinite"></animate></circle>',da=$e({name:"QSpinnerDots",props:Ft,setup(e){const{cSize:t,classes:o}=Ht(e);return()=>W("svg",{class:o.value,fill:"currentColor",width:t.value,height:t.value,viewBox:"0 0 120 30",xmlns:"http://www.w3.org/2000/svg",innerHTML:ia})}}),ua=$e({name:"QInnerLoading",props:{...zt,...Et,showing:Boolean,color:String,size:{type:[String,Number],default:"42px"},label:String,labelClass:String,labelStyle:[String,Array,Object]},setup(e,{slots:t}){const o=Zt(),r=Lt(e,o.proxy.$q),{transitionProps:u,transitionStyle:m}=jt(e),_=Y(()=>"q-inner-loading q--avoid-card-border absolute-full column flex-center"+(r.value===!0?" q-inner-loading--dark":"")),g=Y(()=>"q-inner-loading__label"+(e.labelClass!==void 0?` ${e.labelClass}`:""));function y(){const n=[W(Kt,{size:e.size,color:e.color})];return e.label!==void 0&&n.push(W("div",{class:g.value,style:e.labelStyle},[e.label])),n}function d(){return e.showing===!0?W("div",{class:_.value,style:m.value},t.default!==void 0?t.default():y()):null}return()=>W(Xt,u.value,d)}}),st=$e({name:"QBtnGroup",props:{unelevated:Boolean,outline:Boolean,flat:Boolean,rounded:Boolean,square:Boolean,push:Boolean,stretch:Boolean,glossy:Boolean,spread:Boolean},setup(e,{slots:t}){const o=Y(()=>{const r=["unelevated","outline","flat","rounded","square","push","stretch","glossy"].filter(u=>e[u]===!0).map(u=>`q-btn-group--${u}`).join(" ");return`q-btn-group row no-wrap${r.length!==0?" "+r:""}`+(e.spread===!0?" q-btn-group--spread":" inline")});return()=>W("div",{class:o.value},ct(t.default))}}),rt=$e({name:"QTr",props:{props:Object,noHover:Boolean},setup(e,{slots:t}){const o=Y(()=>"q-tr"+(e.props===void 0||e.props.header===!0?"":" "+e.props.__trClass)+(e.noHover===!0?" q-tr--no-hover":""));return()=>{var r;return W("tr",{style:(r=e.props)==null?void 0:r.__trStyle,class:o.value},ct(t.default))}}}),Je=je("payments",()=>{const e=R([]),t=R(!1),o=R(null);return{payments:e,loading:t,error:o,fetchPayments:async(g={})=>{t.value=!0,o.value=null;try{console.log("Загрузка платежей с фильтрами:",g);const y=ue(F,"payments");let d=Q(y,mt("date","desc"));g.buildingId&&(d=Q(d,K("buildingId","==",g.buildingId))),g.apartmentId&&(d=Q(d,K("apartmentId","==",g.apartmentId))),g.residentId&&(d=Q(d,K("residentId","==",g.residentId)));const n=await Xe(d),i=[];return n.forEach($=>{const I={id:$.id,...$.data()};i.push(I)}),console.log("Загружено платежей:",i.length),e.value=i,i}catch(y){throw console.error("Ошибка при загрузке платежей:",y),y}finally{t.value=!1}},addPayment:async g=>{try{const y=ue(F,"payments"),d=await Ke(y,{...g,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),n={id:d.id,...g};return e.value.push(n),d.id}catch(y){throw console.error("Ошибка при добавлении платежа:",y),y}},updatePayment:async(g,y)=>{try{const d=ce(F,"payments",g);await Ge(d,{...y,updatedAt:new Date().toISOString()});const n=e.value.findIndex(i=>i.id===g);n!==-1&&(e.value[n]={...e.value[n],...y})}catch(d){throw console.error("Ошибка при обновлении платежа:",d),d}},deletePayment:async g=>{try{const y=ce(F,"payments",g);await We(y),e.value=e.value.filter(d=>d.id!==g)}catch(y){throw console.error("Ошибка при удалении платежа:",y),y}}}}),yt=je("receipts",()=>{const e=R([]),t=R(!1),o=R(null);return{receipts:e,loading:t,error:o,fetchReceipts:async(d={})=>{t.value=!0,o.value=null;try{console.log("Загрузка квитанций с фильтрами:",d);const n=ue(F,"receipts");let i=Q(n);d.buildingId&&(i=Q(i,K("buildingId","==",d.buildingId))),d.apartmentId&&(i=Q(i,K("apartmentId","==",d.apartmentId))),d.residentId&&(i=Q(i,K("residentId","==",d.residentId)));const $=await Xe(i),I=[];return $.forEach(s=>{const b={id:s.id,...s.data()};if(d.from&&d.to){const V=new Date(b.date),M=new Date(d.from),N=new Date(d.to);V>=M&&V<=N&&I.push(b)}else I.push(b)}),I.sort((s,b)=>new Date(b.date)-new Date(s.date)),console.log("Загружено квитанций:",I.length),I.value=I,I}catch(n){throw console.error("Ошибка при загрузке квитанций:",n),n}finally{t.value=!1}},addReceipt:async d=>{try{const n=ue(F,"receipts"),i=await Ke(n,{...d,date:new Date().toISOString()}),$={id:i.id,...d};return e.value.unshift($),i.id}catch(n){throw console.error("Ошибка при добавлении квитанции:",n),n}},updateReceipt:async(d,n)=>{try{const i=ce(F,"receipts",d);await Ge(i,n);const $=e.value.findIndex(I=>I.id===d);$!==-1&&(e.value[$]={...e.value[$],...n})}catch(i){throw console.error("Ошибка при обновлении квитанции:",i),i}},deleteReceipt:async d=>{try{const n=ce(F,"receipts",d);await We(n),e.value=e.value.filter(i=>i.id!==d)}catch(n){throw console.error("Ошибка при удалении квитанции:",n),n}},getReceiptsByPayment:d=>e.value.filter(n=>n.paymentId===d),getReceiptsByInvoice:d=>e.value.filter(n=>n.invoiceId===d)}}),bt=je("services",()=>{const e=R([]),t=R(!1),o=R(null),r=Y(()=>I=>e.value.filter(s=>s.buildingId===I)),u=Y(()=>I=>e.value.filter(s=>s.apartmentId===I)),m=Y(()=>I=>e.value.filter(s=>s.residentId===I)),_=Y(()=>I=>r.value(I).reduce((b,V)=>b+(V.amount||0),0)),g=Y(()=>I=>u.value(I).reduce((b,V)=>b+(V.amount||0),0)),y=Y(()=>I=>m.value(I).reduce((b,V)=>b+(V.amount||0),0));return{services:e,loading:t,error:o,fetchServices:async(I={})=>{t.value=!0,o.value=null;try{console.log("Загрузка услуг с фильтрами:",I);const s=ue(F,"services");let b=Q(s);I.buildingId&&(b=Q(b,K("buildingId","==",I.buildingId))),I.apartmentId&&(b=Q(b,K("apartmentId","==",I.apartmentId))),I.residentId&&(b=Q(b,K("residentId","==",I.residentId))),b=Q(b,mt("date","desc"));const V=await Xe(b),M=[];return V.forEach(N=>{const w={id:N.id,...N.data()};M.push(w)}),console.log("Загружено услуг:",M.length),M.value=M,M}catch(s){throw console.error("Ошибка при загрузке услуг:",s),s}finally{t.value=!1}},addService:async I=>{try{const s=ue(F,"services"),b=await Ke(s,{...I,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),V={id:b.id,...I};return e.value.unshift(V),b.id}catch(s){throw console.error("Ошибка при добавлении услуги:",s),s}},updateService:async(I,s)=>{try{const b=ce(F,"services",I);await Ge(b,{...s,updatedAt:new Date().toISOString()});const V=e.value.findIndex(M=>M.id===I);V!==-1&&(e.value[V]={...e.value[V],...s})}catch(b){throw console.error("Ошибка при обновлении услуги:",b),b}},deleteService:async I=>{try{const s=ce(F,"services",I);await We(s),e.value=e.value.filter(b=>b.id!==I)}catch(s){throw console.error("Ошибка при удалении услуги:",s),s}},getServicesByBuilding:r,getServicesByApartment:u,getServicesByResident:m,getTotalServicesByBuilding:_,getTotalServicesByApartment:g,getTotalServicesByResident:y}}),ht=864e5,ca=36e5,Ze=6e4,It="YYYY-MM-DDTHH:mm:ss.SSSZ",ma=/\[((?:[^\]\\]|\\]|\\)*)\]|do|d{1,4}|Mo|M{1,4}|m{1,2}|wo|w{1,2}|Qo|Do|DDDo|D{1,4}|YY(?:YY)?|H{1,2}|h{1,2}|s{1,2}|S{1,3}|Z{1,2}|a{1,2}|[AQExX]/g,va=/(\[[^\]]*\])|do|d{1,4}|Mo|M{1,4}|m{1,2}|wo|w{1,2}|Qo|Do|DDDo|D{1,4}|YY(?:YY)?|H{1,2}|h{1,2}|s{1,2}|S{1,3}|Z{1,2}|a{1,2}|[AQExX]|([.*+:?^,\s${}()|\\]+)/g,ze={};function fa(e,t){const o="("+t.days.join("|")+")",r=e+o;if(ze[r]!==void 0)return ze[r];const u="("+t.daysShort.join("|")+")",m="("+t.months.join("|")+")",_="("+t.monthsShort.join("|")+")",g={};let y=0;const d=e.replace(va,i=>{switch(y++,i){case"YY":return g.YY=y,"(-?\\d{1,2})";case"YYYY":return g.YYYY=y,"(-?\\d{1,4})";case"M":return g.M=y,"(\\d{1,2})";case"Mo":return g.M=y++,"(\\d{1,2}(st|nd|rd|th))";case"MM":return g.M=y,"(\\d{2})";case"MMM":return g.MMM=y,_;case"MMMM":return g.MMMM=y,m;case"D":return g.D=y,"(\\d{1,2})";case"Do":return g.D=y++,"(\\d{1,2}(st|nd|rd|th))";case"DD":return g.D=y,"(\\d{2})";case"H":return g.H=y,"(\\d{1,2})";case"HH":return g.H=y,"(\\d{2})";case"h":return g.h=y,"(\\d{1,2})";case"hh":return g.h=y,"(\\d{2})";case"m":return g.m=y,"(\\d{1,2})";case"mm":return g.m=y,"(\\d{2})";case"s":return g.s=y,"(\\d{1,2})";case"ss":return g.s=y,"(\\d{2})";case"S":return g.S=y,"(\\d{1})";case"SS":return g.S=y,"(\\d{2})";case"SSS":return g.S=y,"(\\d{3})";case"A":return g.A=y,"(AM|PM)";case"a":return g.a=y,"(am|pm)";case"aa":return g.aa=y,"(a\\.m\\.|p\\.m\\.)";case"ddd":return u;case"dddd":return o;case"Q":case"d":case"E":return"(\\d{1})";case"do":return y++,"(\\d{1}(st|nd|rd|th))";case"Qo":return"(1st|2nd|3rd|4th)";case"DDD":case"DDDD":return"(\\d{1,3})";case"DDDo":return y++,"(\\d{1,3}(st|nd|rd|th))";case"w":return"(\\d{1,2})";case"wo":return y++,"(\\d{1,2}(st|nd|rd|th))";case"ww":return"(\\d{2})";case"Z":return g.Z=y,"(Z|[+-]\\d{2}:\\d{2})";case"ZZ":return g.ZZ=y,"(Z|[+-]\\d{2}\\d{2})";case"X":return g.X=y,"(-?\\d+)";case"x":return g.x=y,"(-?\\d{4,})";default:return y--,i[0]==="["&&(i=i.substring(1,i.length-1)),i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}}),n={map:g,regex:new RegExp("^"+d)};return ze[r]=n,n}function wt(e,t){return e!==void 0?e:t!==void 0?t.date:Gt.date}function it(e,t=""){const o=e>0?"-":"+",r=Math.abs(e),u=Math.floor(r/60),m=r%60;return o+B(u)+t+B(m)}function pa(e,t,o){let r=e.getFullYear(),u=e.getMonth();const m=e.getDate();return t.year!==void 0&&(r+=o*t.year,delete t.year),t.month!==void 0&&(u+=o*t.month,delete t.month),e.setDate(1),e.setMonth(2),e.setFullYear(r),e.setMonth(u),e.setDate(Math.min(m,tt(e))),t.date!==void 0&&(e.setDate(e.getDate()+o*t.date),delete t.date),e}function ga(e,t,o){const r=t.year!==void 0?t.year:e[`get${o}FullYear`](),u=t.month!==void 0?t.month-1:e[`get${o}Month`](),m=new Date(r,u+1,0).getDate(),_=Math.min(m,t.date!==void 0?t.date:e[`get${o}Date`]());return e[`set${o}Date`](1),e[`set${o}Month`](2),e[`set${o}FullYear`](r),e[`set${o}Month`](u),e[`set${o}Date`](_),delete t.year,delete t.month,delete t.date,e}function et(e,t,o){const r=Dt(t),u=new Date(e),m=r.year!==void 0||r.month!==void 0||r.date!==void 0?pa(u,r,o):u;for(const _ in r){const g=oa(_);m[`set${g}`](m[`get${g}`]()+o*r[_])}return m}function Dt(e){const t={...e};return e.years!==void 0&&(t.year=e.years,delete t.years),e.months!==void 0&&(t.month=e.months,delete t.months),e.days!==void 0&&(t.date=e.days,delete t.days),e.day!==void 0&&(t.date=e.day,delete t.day),e.hour!==void 0&&(t.hours=e.hour,delete t.hour),e.minute!==void 0&&(t.minutes=e.minute,delete t.minute),e.second!==void 0&&(t.seconds=e.second,delete t.second),e.millisecond!==void 0&&(t.milliseconds=e.millisecond,delete t.millisecond),t}function St(e,t,o){const r=Dt(t),u=o===!0?"UTC":"",m=new Date(e),_=r.year!==void 0||r.month!==void 0||r.date!==void 0?ga(m,r,u):m;for(const g in r){const y=g.charAt(0).toUpperCase()+g.slice(1);_[`set${u}${y}`](r[g])}return _}function ya(e,t,o){const r=ba(e,t,o),u=new Date(r.year,r.month===null?null:r.month-1,r.day===null?1:r.day,r.hour,r.minute,r.second,r.millisecond),m=u.getTimezoneOffset();return r.timezoneOffset===null||r.timezoneOffset===m?u:et(u,{minutes:r.timezoneOffset-m},1)}function ba(e,t,o,r,u){const m={year:null,month:null,day:null,hour:null,minute:null,second:null,millisecond:null,timezoneOffset:null,dateHash:null,timeHash:null};if(e==null||e===""||typeof e!="string")return m;t===void 0&&(t=It);const _=wt(o,vt.props),g=_.months,y=_.monthsShort,{regex:d,map:n}=fa(t,_),i=e.match(d);if(i===null)return m;let $="";if(n.X!==void 0||n.x!==void 0){const I=parseInt(i[n.X!==void 0?n.X:n.x],10);if(isNaN(I)===!0||I<0)return m;const s=new Date(I*(n.X!==void 0?1e3:1));m.year=s.getFullYear(),m.month=s.getMonth()+1,m.day=s.getDate(),m.hour=s.getHours(),m.minute=s.getMinutes(),m.second=s.getSeconds(),m.millisecond=s.getMilliseconds()}else{if(n.YYYY!==void 0)m.year=parseInt(i[n.YYYY],10);else if(n.YY!==void 0){const I=parseInt(i[n.YY],10);m.year=I<0?I:2e3+I}if(n.M!==void 0){if(m.month=parseInt(i[n.M],10),m.month<1||m.month>12)return m}else n.MMM!==void 0?m.month=y.indexOf(i[n.MMM])+1:n.MMMM!==void 0&&(m.month=g.indexOf(i[n.MMMM])+1);if(n.D!==void 0){if(m.day=parseInt(i[n.D],10),m.year===null||m.month===null||m.day<1)return m;const I=new Date(m.year,m.month,0).getDate();if(m.day>I)return m}n.H!==void 0?m.hour=parseInt(i[n.H],10)%24:n.h!==void 0&&(m.hour=parseInt(i[n.h],10)%12,(n.A&&i[n.A]==="PM"||n.a&&i[n.a]==="pm"||n.aa&&i[n.aa]==="p.m.")&&(m.hour+=12),m.hour=m.hour%24),n.m!==void 0&&(m.minute=parseInt(i[n.m],10)%60),n.s!==void 0&&(m.second=parseInt(i[n.s],10)%60),n.S!==void 0&&(m.millisecond=parseInt(i[n.S],10)*10**(3-i[n.S].length)),(n.Z!==void 0||n.ZZ!==void 0)&&($=n.Z!==void 0?i[n.Z].replace(":",""):i[n.ZZ],m.timezoneOffset=($[0]==="+"?-1:1)*(60*$.slice(1,3)+1*$.slice(3,5)))}return m.dateHash=B(m.year,6)+"/"+B(m.month)+"/"+B(m.day),m.timeHash=B(m.hour)+":"+B(m.minute)+":"+B(m.second)+$,m}function ha(e){return typeof e=="number"?!0:isNaN(Date.parse(e))===!1}function Ia(e,t){return St(new Date,e,t)}function wa(e){const t=new Date(e).getDay();return t===0?7:t}function Pe(e){const t=new Date(e.getFullYear(),e.getMonth(),e.getDate());t.setDate(t.getDate()-(t.getDay()+6)%7+3);const o=new Date(t.getFullYear(),0,4);o.setDate(o.getDate()-(o.getDay()+6)%7+3);const r=t.getTimezoneOffset()-o.getTimezoneOffset();t.setHours(t.getHours()-r);const u=(t-o)/(ht*7);return 1+Math.floor(u)}function Da(e){return e.getFullYear()*1e4+e.getMonth()*100+e.getDate()}function Le(e,t){const o=new Date(e);return t===!0?Da(o):o.getTime()}function Sa(e,t,o,r={}){const u=Le(t,r.onlyDate),m=Le(o,r.onlyDate),_=Le(e,r.onlyDate);return(_>u||r.inclusiveFrom===!0&&_===u)&&(_<m||r.inclusiveTo===!0&&_===m)}function Ma(e,t){return et(e,t,1)}function _a(e,t){return et(e,t,-1)}function Z(e,t,o){const r=new Date(e),u=`set${o===!0?"UTC":""}`;switch(t){case"year":case"years":r[`${u}Month`](0);case"month":case"months":r[`${u}Date`](1);case"day":case"days":case"date":r[`${u}Hours`](0);case"hour":case"hours":r[`${u}Minutes`](0);case"minute":case"minutes":r[`${u}Seconds`](0);case"second":case"seconds":r[`${u}Milliseconds`](0)}return r}function Va(e,t,o){const r=new Date(e),u=`set${o===!0?"UTC":""}`;switch(t){case"year":case"years":r[`${u}Month`](11);case"month":case"months":r[`${u}Date`](tt(r));case"day":case"days":case"date":r[`${u}Hours`](23);case"hour":case"hours":r[`${u}Minutes`](59);case"minute":case"minutes":r[`${u}Seconds`](59);case"second":case"seconds":r[`${u}Milliseconds`](999)}return r}function $a(e){let t=new Date(e);return Array.prototype.slice.call(arguments,1).forEach(o=>{t=Math.max(t,new Date(o))}),t}function Ya(e){let t=new Date(e);return Array.prototype.slice.call(arguments,1).forEach(o=>{t=Math.min(t,new Date(o))}),t}function Ce(e,t,o){return(e.getTime()-e.getTimezoneOffset()*Ze-(t.getTime()-t.getTimezoneOffset()*Ze))/o}function Mt(e,t,o="days"){const r=new Date(e),u=new Date(t);switch(o){case"years":case"year":return r.getFullYear()-u.getFullYear();case"months":case"month":return(r.getFullYear()-u.getFullYear())*12+r.getMonth()-u.getMonth();case"days":case"day":case"date":return Ce(Z(r,"day"),Z(u,"day"),ht);case"hours":case"hour":return Ce(Z(r,"hour"),Z(u,"hour"),ca);case"minutes":case"minute":return Ce(Z(r,"minute"),Z(u,"minute"),Ze);case"seconds":case"second":return Ce(Z(r,"second"),Z(u,"second"),1e3)}}function qe(e){return Mt(e,Z(e,"year"),"days")+1}function Ra(e){return ft(e)===!0?"date":typeof e=="number"?"number":"string"}function Na(e,t,o){const r=new Date(e);if(t){const u=new Date(t);if(r<u)return u}if(o){const u=new Date(o);if(r>u)return u}return r}function Ua(e,t,o){const r=new Date(e),u=new Date(t);if(o===void 0)return r.getTime()===u.getTime();switch(o){case"second":case"seconds":if(r.getSeconds()!==u.getSeconds())return!1;case"minute":case"minutes":if(r.getMinutes()!==u.getMinutes())return!1;case"hour":case"hours":if(r.getHours()!==u.getHours())return!1;case"day":case"days":case"date":if(r.getDate()!==u.getDate())return!1;case"month":case"months":if(r.getMonth()!==u.getMonth())return!1;case"year":case"years":if(r.getFullYear()!==u.getFullYear())return!1;break;default:throw new Error(`date isSameDate unknown unit ${o}`)}return!0}function tt(e){return new Date(e.getFullYear(),e.getMonth()+1,0).getDate()}function de(e){if(e>=11&&e<=13)return`${e}th`;switch(e%10){case 1:return`${e}st`;case 2:return`${e}nd`;case 3:return`${e}rd`}return`${e}th`}const dt={YY(e,t,o){const r=this.YYYY(e,t,o)%100;return r>=0?B(r):"-"+B(Math.abs(r))},YYYY(e,t,o){return o??e.getFullYear()},M(e){return e.getMonth()+1},Mo(e){return de(e.getMonth()+1)},MM(e){return B(e.getMonth()+1)},MMM(e,t){return t.monthsShort[e.getMonth()]},MMMM(e,t){return t.months[e.getMonth()]},Q(e){return Math.ceil((e.getMonth()+1)/3)},Qo(e){return de(this.Q(e))},D(e){return e.getDate()},Do(e){return de(e.getDate())},DD(e){return B(e.getDate())},DDD(e){return qe(e)},DDDo(e){return de(qe(e))},DDDD(e){return B(qe(e),3)},d(e){return e.getDay()},do(e){return de(e.getDay())},dd(e,t){return t.days[e.getDay()].slice(0,2)},ddd(e,t){return t.daysShort[e.getDay()]},dddd(e,t){return t.days[e.getDay()]},E(e){return e.getDay()||7},w(e){return Pe(e)},wo(e){return de(Pe(e))},ww(e){return B(Pe(e))},H(e){return e.getHours()},HH(e){return B(e.getHours())},h(e){const t=e.getHours();return t===0?12:t>12?t%12:t},hh(e){return B(this.h(e))},m(e){return e.getMinutes()},mm(e){return B(e.getMinutes())},s(e){return e.getSeconds()},ss(e){return B(e.getSeconds())},S(e){return Math.floor(e.getMilliseconds()/100)},SS(e){return B(Math.floor(e.getMilliseconds()/10))},SSS(e){return B(e.getMilliseconds(),3)},A(e){return e.getHours()<12?"AM":"PM"},a(e){return e.getHours()<12?"am":"pm"},aa(e){return e.getHours()<12?"a.m.":"p.m."},Z(e,t,o,r){const u=r??e.getTimezoneOffset();return it(u,":")},ZZ(e,t,o,r){const u=r??e.getTimezoneOffset();return it(u)},X(e){return Math.floor(e.getTime()/1e3)},x(e){return e.getTime()}};function ka(e,t,o,r,u){if(e!==0&&!e||e===1/0||e===-1/0)return;const m=new Date(e);if(isNaN(m))return;t===void 0&&(t=It);const _=wt(o,vt.props);return t.replace(ma,(g,y)=>g in dt?dt[g](m,_,r,u):y===void 0?g:y.split("\\]").join("]"))}function xa(e){return ft(e)===!0?new Date(e.getTime()):e}const ve={isValid:ha,extractDate:ya,buildDate:Ia,getDayOfWeek:wa,getWeekOfYear:Pe,isBetweenDates:Sa,addToDate:Ma,subtractFromDate:_a,adjustDate:St,startOfDate:Z,endOfDate:Va,getMaxDate:$a,getMinDate:Ya,getDateDiff:Mt,getDayOfYear:qe,inferDateFormat:Ra,getDateBetween:Na,isSameDate:Ua,daysInMonth:tt,formatDate:ka,clone:xa};function ut(e){if(e===!1)return 0;if(e===!0||e===void 0)return 1;const t=parseInt(e,10);return isNaN(t)?0:t}const fe=Wt({name:"close-popup",beforeMount(e,{value:t}){const o={depth:ut(t),handler(r){o.depth!==0&&setTimeout(()=>{const u=ea(e);u!==void 0&&ta(u,r,o.depth)})},handlerKey(r){Jt(r,13)===!0&&o.handler(r)}};e.__qclosepopup=o,e.addEventListener("click",o.handler),e.addEventListener("keyup",o.handlerKey)},updated(e,{value:t,oldValue:o}){t!==o&&(e.__qclosepopup.depth=ut(t))},beforeUnmount(e){const t=e.__qclosepopup;e.removeEventListener("click",t.handler),e.removeEventListener("keyup",t.handlerKey),delete e.__qclosepopup}}),Ca={class:"text-h6"},Pa={class:"row q-col-gutter-md"},qa={class:"col-12 col-md-6"},Ba={class:"col-12 col-md-6"},Oa={class:"col-12 col-md-6"},Aa={class:"col-12 col-md-6"},Ta={class:"col-12 col-md-6"},Qa={class:"col-12 col-md-6"},Fa={class:"col-12 col-md-6"},Ha={class:"col-12"},Ea={__name:"PaymentModal",props:{show:Boolean,editingPayment:Object},emits:["update:show","saved"],setup(e,{emit:t}){const o=e,r=t,u=pe(),m=ge(),_=ye(),g=Be(),y=Je(),d=R(!1),n=R({buildingId:"",apartmentId:"",residentId:"",amount:0,type:"utility",status:"pending",date:new Date().toISOString()}),i=[{label:"Коммунальные услуги",value:"utility"},{label:"Ремонт",value:"repair"},{label:"Другое",value:"other"}],$=Y(()=>u.buildings.map(w=>({label:w.name,value:w.id}))),I=Y(()=>n.value.buildingId?m.apartments.filter(w=>w.buildingId===n.value.buildingId).map(w=>({label:`Квартира ${w.number}`,value:w.id})):[]),s=Y(()=>n.value.apartmentId?_.residents.filter(w=>w.apartmentId===n.value.apartmentId).map(w=>({label:`${w.lastName} ${w.firstName}`,value:w.id})):[]),b=Y(()=>n.value.apartmentId?g.invoices.filter(w=>w.apartmentId===n.value.apartmentId&&w.status==="pending").map(w=>({label:`${w.period.month}/${w.period.year} - ${w.total} ₽`,value:w.id})):[]),V=async w=>{n.value.buildingId=w,n.value.apartmentId=null,n.value.residentId=null;try{d.value=!0,await m.fetchApartments({buildingId:w})}catch(x){console.error("Ошибка при загрузке квартир:",x)}finally{d.value=!1}},M=async w=>{n.value.apartmentId=w,n.value.residentId=null;try{d.value=!0,await _.fetchResidents({apartmentId:w})}catch(x){console.error("Ошибка при загрузке жильцов:",x)}finally{d.value=!1}},N=async()=>{try{d.value=!0,console.log("Сохранение платежа:",n.value),o.editingPayment?(await y.updatePayment(o.editingPayment.id,n.value),console.log("Платеж обновлен")):(await y.addPayment(n.value),console.log("Платеж добавлен")),r("saved"),r("update:show",!1)}catch(w){console.error("Ошибка при сохранении платежа:",w)}finally{d.value=!1}};return Oe(async()=>{try{d.value=!0,u.buildings.length||await u.fetchBuildings(),o.editingPayment&&(n.value={...o.editingPayment},o.editingPayment.buildingId&&await m.fetchApartments({buildingId:o.editingPayment.buildingId}),o.editingPayment.apartmentId&&await _.fetchResidents({apartmentId:o.editingPayment.apartmentId}))}catch(w){console.error("Ошибка при инициализации:",w)}finally{d.value=!1}}),re(()=>o.editingPayment,w=>{w?n.value={...w}:n.value={buildingId:"",apartmentId:"",residentId:"",amount:0,type:"utility",status:"pending",date:new Date().toISOString()}},{immediate:!0}),(w,x)=>(H(),Ye(Ne,{"model-value":e.show,"onUpdate:modelValue":x[8]||(x[8]=C=>w.$emit("update:show",C)),persistent:""},{default:f(()=>[a(j,{style:{"min-width":"500px"}},{default:f(()=>[a(A,null,{default:f(()=>[v("div",Ca,U(e.editingPayment?"Редактировать платеж":"Добавить платеж"),1)]),_:1}),a(A,null,{default:f(()=>[v("div",Pa,[v("div",qa,[a(k,{modelValue:n.value.buildingId,"onUpdate:modelValue":[x[0]||(x[0]=C=>n.value.buildingId=C),V],options:$.value,label:"Здание"},null,8,["modelValue","options"])]),v("div",Ba,[a(k,{modelValue:n.value.apartmentId,"onUpdate:modelValue":[x[1]||(x[1]=C=>n.value.apartmentId=C),M],options:I.value,label:"Квартира"},null,8,["modelValue","options"])]),v("div",Oa,[a(k,{modelValue:n.value.residentId,"onUpdate:modelValue":x[2]||(x[2]=C=>n.value.residentId=C),options:s.value,label:"Жилец"},null,8,["modelValue","options"])]),v("div",Aa,[a(k,{modelValue:n.value.invoiceId,"onUpdate:modelValue":x[3]||(x[3]=C=>n.value.invoiceId=C),options:b.value,label:"Счет"},null,8,["modelValue","options"])]),v("div",Ta,[a(T,{modelValue:n.value.amount,"onUpdate:modelValue":x[4]||(x[4]=C=>n.value.amount=C),modelModifiers:{number:!0},type:"number",label:"Сумма",prefix:"₽"},null,8,["modelValue"])]),v("div",Qa,[a(T,{modelValue:n.value.date,"onUpdate:modelValue":x[5]||(x[5]=C=>n.value.date=C),type:"date",label:"Дата"},null,8,["modelValue"])]),v("div",Fa,[a(k,{modelValue:n.value.type,"onUpdate:modelValue":x[6]||(x[6]=C=>n.value.type=C),options:i,label:"Тип платежа"},null,8,["modelValue"])]),v("div",Ha,[a(T,{modelValue:n.value.description,"onUpdate:modelValue":x[7]||(x[7]=C=>n.value.description=C),type:"textarea",label:"Описание"},null,8,["modelValue"])])])]),_:1}),a(Re,{align:"right"},{default:f(()=>[me(a(q,{flat:"",label:"Отмена",color:"primary"},null,512),[[fe]]),a(q,{label:"Сохранить",color:"primary",onClick:N})]),_:1})]),_:1})]),_:1},8,["model-value"]))}},za={class:"row q-col-gutter-md"},La={class:"col-12 col-md-6"},Za={class:"col-12 col-md-6"},ja={class:"col-12"},Xa={class:"col-12"},Ka={class:"col-12"},Ga={class:"col-12"},Wa={class:"col-12"},Ja={__name:"ReceiptModal",props:{show:Boolean,payment:Object},emits:["update:show","saved"],setup(e,{emit:t}){const o=e,r=t,u=pe(),m=ge(),_=ye(),g=Be();Je();const y=yt(),d=s=>new Date(s).toLocaleDateString("ru-RU"),n=s=>new Intl.NumberFormat("ru-RU").format(s),i=()=>{const s=new Date,b=s.getFullYear(),V=String(s.getMonth()+1).padStart(2,"0"),M=String(s.getDate()).padStart(2,"0"),N=Math.floor(Math.random()*1e4).toString().padStart(4,"0");return`RCP-${b}${V}${M}-${N}`},$=R({number:i(),date:ve.formatDate(new Date,"YYYY-MM-DD"),paymentId:"",invoiceId:"",buildingId:"",apartmentId:"",residentId:"",amount:0,description:""});Y(()=>o.payment?u.buildings.find(s=>s.id===o.payment.buildingId):null),Y(()=>o.payment?m.apartments.find(s=>s.id===o.payment.apartmentId):null),Y(()=>o.payment?_.residents.find(s=>s.id===o.payment.residentId):null),Y(()=>o.payment?g.invoices.find(s=>s.id===o.payment.invoiceId):null);const I=async()=>{try{console.log("Сохранение квитанции:",$.value),await y.addReceipt($.value),r("saved"),r("update:show",!1)}catch(s){console.error("Ошибка при сохранении квитанции:",s)}};return re(()=>o.payment,s=>{console.log("Изменение платежа:",s),s&&($.value={number:i(),date:ve.formatDate(new Date,"YYYY-MM-DD"),paymentId:s.id,invoiceId:s.invoiceId,buildingId:s.buildingId,apartmentId:s.apartmentId,residentId:s.residentId,amount:s.amount,description:`Квитанция по платежу от ${d(s.date)}`})},{immediate:!0}),re(()=>o.show,s=>{console.log("Изменение видимости модального окна:",s),s&&o.payment&&($.value.number=i())}),(s,b)=>(H(),Ye(Ne,{"model-value":e.show,"onUpdate:modelValue":b[2]||(b[2]=V=>s.$emit("update:show",V)),persistent:""},{default:f(()=>[a(j,{style:{"min-width":"500px"}},{default:f(()=>[a(A,null,{default:f(()=>b[3]||(b[3]=[v("div",{class:"text-h6"},"Создать квитанцию",-1)])),_:1,__:[3]}),a(A,null,{default:f(()=>[v("div",za,[v("div",La,[a(T,{modelValue:$.value.number,"onUpdate:modelValue":b[0]||(b[0]=V=>$.value.number=V),label:"Номер квитанции",readonly:""},null,8,["modelValue"])]),v("div",Za,[a(T,{modelValue:$.value.date,"onUpdate:modelValue":b[1]||(b[1]=V=>$.value.date=V),type:"date",label:"Дата"},null,8,["modelValue"])]),v("div",ja,[a(we,null,{default:f(()=>[a(De,null,{default:f(()=>[a(L,null,{default:f(()=>b[4]||(b[4]=[P("Платеж")])),_:1,__:[4]}),a(L,{caption:""},{default:f(()=>[P(U(e.payment?`${d(e.payment.date)} - ${n(e.payment.amount)} ₽`:"Не выбран"),1)]),_:1})]),_:1})]),_:1})]),v("div",Xa,[a(we,null,{default:f(()=>[a(De,null,{default:f(()=>[a(L,null,{default:f(()=>b[5]||(b[5]=[P("Счет")])),_:1,__:[5]}),a(L,{caption:""},{default:f(()=>[P(U(s.invoice?`${s.invoice.period.month}/${s.invoice.period.year} - ${n(s.invoice.total)} ₽`:"Не выбран"),1)]),_:1})]),_:1})]),_:1})]),v("div",Ka,[a(we,null,{default:f(()=>[a(De,null,{default:f(()=>[a(L,null,{default:f(()=>b[6]||(b[6]=[P("Жилец")])),_:1,__:[6]}),a(L,{caption:""},{default:f(()=>[P(U(s.resident?`${s.resident.lastName} ${s.resident.firstName}`:"Не выбран"),1)]),_:1})]),_:1})]),_:1})]),v("div",Ga,[a(we,null,{default:f(()=>[a(De,null,{default:f(()=>[a(L,null,{default:f(()=>b[7]||(b[7]=[P("Квартира")])),_:1,__:[7]}),a(L,{caption:""},{default:f(()=>[P(U(s.apartment?s.apartment.number:"Не выбрана"),1)]),_:1})]),_:1})]),_:1})]),v("div",Wa,[a(we,null,{default:f(()=>[a(De,null,{default:f(()=>[a(L,null,{default:f(()=>b[8]||(b[8]=[P("Здание")])),_:1,__:[8]}),a(L,{caption:""},{default:f(()=>[P(U(s.building?s.building.name:"Не выбрано"),1)]),_:1})]),_:1})]),_:1})])])]),_:1}),a(Re,{align:"right"},{default:f(()=>[me(a(q,{flat:"",label:"Отмена",color:"primary"},null,512),[[fe]]),a(q,{label:"Создать",color:"primary",onClick:I})]),_:1})]),_:1})]),_:1},8,["model-value"]))}},el={class:"text-h6"},tl={class:"row q-col-gutter-md"},al={class:"col-12 col-md-6"},ll={class:"col-12 col-md-6"},nl={class:"col-12 col-md-6"},ol={class:"col-12 col-md-6"},sl={class:"col-12 col-md-6"},rl={class:"col-12 col-md-6"},il={class:"col-12"},dl={__name:"DebtModal",props:{show:Boolean,editingDebt:Object},emits:["update:show","saved"],setup(e,{emit:t}){const o=e,r=t,u=pe(),m=ge(),_=ye(),g=pt(),y=R(!1),d=R({buildingId:"",apartmentId:"",residentId:"",amount:0,dueDate:ve.formatDate(new Date,"YYYY-MM-DD"),status:"pending",description:""}),n=[{label:"Ожидает оплаты",value:"pending"},{label:"Частично оплачено",value:"partial"},{label:"Просрочено",value:"overdue"}],i=Y(()=>u.buildings.map(M=>({label:M.name,value:M.id}))),$=Y(()=>d.value.buildingId?m.apartments.filter(M=>M.buildingId===d.value.buildingId).map(M=>({label:M.number,value:M.id})):[]),I=Y(()=>d.value.apartmentId?_.residents.filter(M=>M.apartmentId===d.value.apartmentId).map(M=>({label:`${M.lastName} ${M.firstName}`,value:M.id})):[]),s=async()=>{d.value.buildingId&&await m.fetchApartments(d.value.buildingId),d.value.apartmentId="",d.value.residentId=""},b=async()=>{d.value.apartmentId&&await _.fetchResidents(d.value.apartmentId),d.value.residentId=""},V=async()=>{try{console.log("Сохранение задолженности:",d.value),o.editingDebt?(await g.updateDebt(o.editingDebt.id,d.value),console.log("Задолженность обновлена")):(await g.addDebt(d.value),console.log("Задолженность добавлена")),r("saved"),r("update:show",!1)}catch(M){console.error("Ошибка при сохранении задолженности:",M)}};return Oe(async()=>{try{console.log("Загрузка начальных данных для модального окна задолженностей"),await u.fetchBuildings(),d.value.buildingId&&await s(),d.value.apartmentId&&await b(),y.value=!0}catch(M){console.error("Ошибка при загрузке начальных данных:",M)}}),aa(()=>{y.value=!1}),re(()=>o.editingDebt,async M=>{console.log("Изменение редактируемой задолженности:",M),M?(d.value={...M},d.value.buildingId&&await s(),d.value.apartmentId&&await b()):d.value={buildingId:"",apartmentId:"",residentId:"",amount:0,dueDate:ve.formatDate(new Date,"YYYY-MM-DD"),status:"pending",description:""}},{immediate:!0}),re(()=>o.show,async M=>{console.log("Изменение видимости модального окна:",M),M&&(await u.fetchBuildings(),d.value.buildingId&&await s(),d.value.apartmentId&&await b())}),(M,N)=>y.value?(H(),Ye(Ne,{key:0,"model-value":e.show,"onUpdate:modelValue":N[7]||(N[7]=w=>M.$emit("update:show",w)),persistent:""},{default:f(()=>[a(j,{style:{"min-width":"500px"}},{default:f(()=>[a(A,null,{default:f(()=>[v("div",el,U(e.editingDebt?"Редактировать задолженность":"Добавить задолженность"),1)]),_:1}),a(A,null,{default:f(()=>[v("div",tl,[v("div",al,[a(k,{modelValue:d.value.buildingId,"onUpdate:modelValue":[N[0]||(N[0]=w=>d.value.buildingId=w),s],options:i.value,label:"Здание"},null,8,["modelValue","options"])]),v("div",ll,[a(k,{modelValue:d.value.apartmentId,"onUpdate:modelValue":[N[1]||(N[1]=w=>d.value.apartmentId=w),b],options:$.value,label:"Квартира"},null,8,["modelValue","options"])]),v("div",nl,[a(k,{modelValue:d.value.residentId,"onUpdate:modelValue":N[2]||(N[2]=w=>d.value.residentId=w),options:I.value,label:"Жилец"},null,8,["modelValue","options"])]),v("div",ol,[a(T,{modelValue:d.value.amount,"onUpdate:modelValue":N[3]||(N[3]=w=>d.value.amount=w),modelModifiers:{number:!0},type:"number",label:"Сумма задолженности",prefix:"₽"},null,8,["modelValue"])]),v("div",sl,[a(T,{modelValue:d.value.dueDate,"onUpdate:modelValue":N[4]||(N[4]=w=>d.value.dueDate=w),type:"date",label:"Срок оплаты"},null,8,["modelValue"])]),v("div",rl,[a(k,{modelValue:d.value.status,"onUpdate:modelValue":N[5]||(N[5]=w=>d.value.status=w),options:n,label:"Статус"},null,8,["modelValue"])]),v("div",il,[a(T,{modelValue:d.value.description,"onUpdate:modelValue":N[6]||(N[6]=w=>d.value.description=w),type:"textarea",label:"Описание"},null,8,["modelValue"])])])]),_:1}),a(Re,{align:"right"},{default:f(()=>[me(a(q,{flat:"",label:"Отмена",color:"primary"},null,512),[[fe]]),a(q,{label:"Сохранить",color:"primary",onClick:V})]),_:1})]),_:1})]),_:1},8,["model-value"])):Ve("",!0)}},ul=Ae(dl,[["__scopeId","data-v-8181f6d1"]]),cl=$e({name:"QSpace",setup(){const e=W("div",{class:"q-space"});return()=>e}}),ml={class:"text-h6"},vl={class:"row q-col-gutter-md"},fl={class:"col-12"},pl={class:"text-subtitle2"},gl={key:0,class:"text-subtitle2"},yl={key:1,class:"text-subtitle2"},bl={key:2,class:"text-subtitle2"},hl={class:"col-12"},Il={class:"text-h6 q-mt-md"},wl={__name:"ReportModal",props:{show:{type:Boolean,required:!0},reportData:{type:Object,required:!0},dateRange:{type:Object,required:!0},selectedBuilding:{type:String,default:""},selectedApartment:{type:String,default:""},selectedResident:{type:String,default:""}},emits:["update:show"],setup(e,{emit:t}){const o=e,r=pe(),u=ge(),m=ye(),_=Y(()=>{switch(o.reportData.title){case"Отчет по платежам":return[{name:"date",label:"Дата",field:"date",format:s=>g(s)},{name:"building",label:"Здание",field:"buildingId",format:s=>d(s)},{name:"apartment",label:"Квартира",field:"apartmentId",format:s=>n(s)},{name:"resident",label:"Жилец",field:"residentId",format:s=>i(s)},{name:"amount",label:"Сумма",field:"amount",format:s=>y(s)},{name:"type",label:"Тип платежа",field:"type"},{name:"status",label:"Статус",field:"status"}];case"Отчет по задолженностям":return[{name:"building",label:"Здание",field:"buildingId",format:s=>d(s)},{name:"apartment",label:"Квартира",field:"apartmentId",format:s=>n(s)},{name:"resident",label:"Жилец",field:"residentId",format:s=>i(s)},{name:"amount",label:"Сумма задолженности",field:"amount",format:s=>y(s)},{name:"dueDate",label:"Срок оплаты",field:"dueDate",format:s=>g(s)}];case"Отчет по счетам":return[{name:"date",label:"Дата",field:"date",format:s=>g(s)},{name:"building",label:"Здание",field:"buildingId",format:s=>d(s)},{name:"apartment",label:"Квартира",field:"apartmentId",format:s=>n(s)},{name:"resident",label:"Жилец",field:"residentId",format:s=>i(s)},{name:"total",label:"Сумма",field:"total",format:s=>y(s)},{name:"status",label:"Статус",field:"status"}];default:return[]}}),g=s=>new Date(s).toLocaleDateString("ru-RU"),y=s=>new Intl.NumberFormat("ru-RU").format(s),d=s=>{const b=r.buildings.find(V=>V.id===s);return b?b.name:"Неизвестное здание"},n=s=>{const b=u.apartments.find(V=>V.id===s);return b?b.number:"Неизвестная квартира"},i=s=>{const b=m.residents.find(V=>V.id===s);return b?`${b.lastName} ${b.firstName}`:"Неизвестный жилец"},$=()=>{console.log("Экспорт в PDF")},I=()=>{console.log("Экспорт в Excel")};return(s,b)=>(H(),Ye(Ne,{"model-value":e.show,"onUpdate:modelValue":b[0]||(b[0]=V=>s.$emit("update:show",V)),persistent:""},{default:f(()=>[a(j,{style:{"min-width":"700px"}},{default:f(()=>[a(A,{class:"row items-center"},{default:f(()=>[v("div",ml,U(e.reportData.title),1),a(cl),me(a(q,{icon:"close",flat:"",round:"",dense:""},null,512),[[fe]])]),_:1}),a(A,null,{default:f(()=>[v("div",vl,[v("div",fl,[v("div",pl,"Период: "+U(g(e.dateRange.from))+" - "+U(g(e.dateRange.to)),1),e.selectedBuilding?(H(),se("div",gl," Здание: "+U(d(e.selectedBuilding)),1)):Ve("",!0),e.selectedApartment?(H(),se("div",yl," Квартира: "+U(n(e.selectedApartment)),1)):Ve("",!0),e.selectedResident?(H(),se("div",bl," Жилец: "+U(i(e.selectedResident)),1)):Ve("",!0)]),v("div",hl,[a(_e,{rows:e.reportData.data,columns:_.value,"row-key":"id",pagination:{rowsPerPage:0}},{bottom:f(()=>[v("div",Il," Итого: "+U(y(e.reportData.total))+" ₽ ",1)]),_:1},8,["rows","columns"])])])]),_:1}),a(Re,{align:"right"},{default:f(()=>[me(a(q,{flat:"",label:"Закрыть",color:"primary"},null,512),[[fe]]),a(q,{flat:"",label:"Экспорт в PDF",color:"primary",onClick:$}),a(q,{flat:"",label:"Экспорт в Excel",color:"primary",onClick:I})]),_:1})]),_:1})]),_:1},8,["model-value"]))}},Dl=Ae(wl,[["__scopeId","data-v-e6a79985"]]),Sl={class:"text-h6"},Ml={class:"row q-col-gutter-md"},_l={class:"col-12 col-md-6"},Vl={class:"col-12 col-md-6"},$l={class:"col-12 col-md-6"},Yl={class:"col-12 col-md-6"},Rl={class:"col-12 col-md-6"},Nl={class:"col-12"},Ul={class:"col-12 col-md-6"},kl={class:"col-12 col-md-6"},xl={class:"col-12"},Cl={class:"col-12 col-md-6"},Pl={__name:"InvoiceModal",props:{show:Boolean,editingInvoice:Object,invoiceForm:Object},emits:["update:show","saved"],setup(e,{emit:t}){const o=e,r=t,u=pe(),m=ge(),_=ye(),g=gt(),y=Be(),d=bt(),n=R(!1),i=R({buildingId:"",apartmentId:"",residentId:"",period:{month:new Date().getMonth()+1,year:new Date().getFullYear()},services:{},total:0,status:"pending",date:new Date().toISOString()}),$=[{label:"Январь",value:1},{label:"Февраль",value:2},{label:"Март",value:3},{label:"Апрель",value:4},{label:"Май",value:5},{label:"Июнь",value:6},{label:"Июль",value:7},{label:"Август",value:8},{label:"Сентябрь",value:9},{label:"Октябрь",value:10},{label:"Ноябрь",value:11},{label:"Декабрь",value:12}],I=[{label:"Ожидает оплаты",value:"pending"},{label:"Оплачен",value:"paid"},{label:"Просрочен",value:"overdue"}],s=Y(()=>u.buildings.map(h=>({label:h.name,value:h.id}))),b=Y(()=>i.value.buildingId?m.apartments.filter(h=>h.buildingId===i.value.buildingId).map(h=>({label:h.number,value:h.id})):[]),V=Y(()=>i.value.apartmentId?_.residents.filter(h=>h.apartmentId===i.value.apartmentId).map(h=>({label:`${h.lastName} ${h.firstName}`,value:h.id})):[]),M=Y(()=>d.services.map(h=>{var D,S;return{...h,amount:((D=i.value.services[h.id])==null?void 0:D.amount)||0,quantity:((S=i.value.services[h.id])==null?void 0:S.quantity)||0}})),N=Y(()=>M.value.reduce((h,D)=>h+D.amount*D.quantity,0)),w=async h=>{i.value.buildingId=h,i.value.apartmentId=null,i.value.residentId=null,i.value.services={},i.value.total=0;try{n.value=!0,await m.fetchApartments({buildingId:h})}catch(D){console.error("Ошибка при загрузке квартир:",D)}finally{n.value=!1}},x=async h=>{i.value.apartmentId=h,i.value.residentId=null,i.value.services={},i.value.total=0;try{n.value=!0,await _.fetchResidents({apartmentId:h})}catch(D){console.error("Ошибка при загрузке жильцов:",D)}finally{n.value=!1}},C=(h,D,S)=>{i.value.services[h]||(i.value.services[h]={amount:0,quantity:0}),i.value.services[h][D]=S,i.value.total=N.value},J=async()=>{try{n.value=!0,console.log("Сохранение счета:",i.value),o.editingInvoice?(await y.updateInvoice(o.editingInvoice.id,i.value),console.log("Счет обновлен")):(await y.addInvoice(i.value),console.log("Счет добавлен")),r("saved"),r("update:show",!1)}catch(h){console.error("Ошибка при сохранении счета:",h)}finally{n.value=!1}};return Oe(async()=>{var h,D,S;try{n.value=!0,u.buildings.length||await u.fetchBuildings(),g.utilities.length||await g.fetchUtilities(),d.services.length||await d.fetchServices(),o.editingInvoice?(o.editingInvoice.buildingId&&await m.fetchApartments({buildingId:o.editingInvoice.buildingId}),o.editingInvoice.apartmentId&&await _.fetchResidents({apartmentId:o.editingInvoice.apartmentId})):i.value={buildingId:((h=o.invoiceForm)==null?void 0:h.buildingId)||"",apartmentId:((D=o.invoiceForm)==null?void 0:D.apartmentId)||"",residentId:((S=o.invoiceForm)==null?void 0:S.residentId)||"",period:{month:new Date().getMonth()+1,year:new Date().getFullYear()},services:{},total:0,status:"pending",date:new Date().toISOString()}}catch(E){console.error("Ошибка при инициализации:",E)}finally{n.value=!1}}),re(()=>o.invoiceForm,h=>{h&&(i.value={...h},i.value.services||(i.value.services={}),i.value.total=N.value)},{deep:!0}),(h,D)=>(H(),Ye(Ne,{"model-value":e.show,"onUpdate:modelValue":D[7]||(D[7]=S=>h.$emit("update:show",S)),persistent:""},{default:f(()=>[a(j,{style:{"min-width":"500px"}},{default:f(()=>[a(A,null,{default:f(()=>[v("div",Sl,U(e.editingInvoice?"Редактировать счет":"Новый счет"),1)]),_:1}),a(A,null,{default:f(()=>[v("div",Ml,[v("div",_l,[a(k,{modelValue:i.value.buildingId,"onUpdate:modelValue":[D[0]||(D[0]=S=>i.value.buildingId=S),w],options:s.value,label:"Здание"},null,8,["modelValue","options"])]),v("div",Vl,[a(k,{modelValue:i.value.apartmentId,"onUpdate:modelValue":[D[1]||(D[1]=S=>i.value.apartmentId=S),x],options:b.value,label:"Квартира"},null,8,["modelValue","options"])]),v("div",$l,[a(k,{modelValue:i.value.residentId,"onUpdate:modelValue":D[2]||(D[2]=S=>i.value.residentId=S),options:V.value,label:"Жилец"},null,8,["modelValue","options"])]),v("div",Yl,[a(k,{modelValue:i.value.period.month,"onUpdate:modelValue":D[3]||(D[3]=S=>i.value.period.month=S),options:$,label:"Месяц"},null,8,["modelValue"])]),v("div",Rl,[a(T,{modelValue:i.value.period.year,"onUpdate:modelValue":D[4]||(D[4]=S=>i.value.period.year=S),modelModifiers:{number:!0},type:"number",label:"Год"},null,8,["modelValue"])]),v("div",Nl,[D[8]||(D[8]=v("div",{class:"text-subtitle2 q-mb-sm"},"Услуги",-1)),(H(!0),se(na,null,la(M.value,(S,E)=>(H(),se("div",{key:S.id,class:"row q-col-gutter-md q-mb-md"},[v("div",Ul,[a(T,{modelValue:i.value.services[S.id].amount,"onUpdate:modelValue":[X=>i.value.services[S.id].amount=X,X=>C(S.id,"amount",X)],modelModifiers:{number:!0},type:"number",label:S.name,prefix:"₽"},null,8,["modelValue","onUpdate:modelValue","label"])]),v("div",kl,[a(T,{modelValue:i.value.services[S.id].quantity,"onUpdate:modelValue":[X=>i.value.services[S.id].quantity=X,X=>C(S.id,"quantity",X)],type:"number",label:`Количество (${S.unit})`},null,8,["modelValue","onUpdate:modelValue","label"])])]))),128))]),v("div",xl,[a(T,{modelValue:i.value.total,"onUpdate:modelValue":D[5]||(D[5]=S=>i.value.total=S),modelModifiers:{number:!0},type:"number",label:"Итоговая сумма",prefix:"₽",readonly:""},null,8,["modelValue"])]),v("div",Cl,[a(k,{modelValue:i.value.status,"onUpdate:modelValue":D[6]||(D[6]=S=>i.value.status=S),options:I,label:"Статус"},null,8,["modelValue"])])])]),_:1}),a(Re,{align:"right"},{default:f(()=>[me(a(q,{flat:"",label:"Отмена",color:"primary"},null,512),[[fe]]),a(q,{label:"Сохранить",color:"primary",onClick:J})]),_:1})]),_:1})]),_:1},8,["model-value"]))}},ql=Ae(Pl,[["__scopeId","data-v-351e119f"]]),Bl={class:"finance-module"},Ol={class:"finance-tabs"},Al={class:"row q-col-gutter-md"},Tl={class:"col-12"},Ql={class:"row q-col-gutter-md q-mb-md"},Fl={class:"col-12 col-md-3"},Hl={class:"col-12 col-md-3"},El={class:"col-12 col-md-3"},zl={class:"col-12 col-md-3"},Ll={key:0,class:"q-mt-md"},Zl={class:"row q-col-gutter-md"},jl={class:"col-12"},Xl={class:"row q-col-gutter-md q-mb-md"},Kl={class:"col-12 col-md-3"},Gl={class:"col-12 col-md-3"},Wl={class:"col-12 col-md-3"},Jl={class:"col-12 col-md-3"},en={class:"row q-col-gutter-md"},tn={class:"col-12"},an={class:"row q-col-gutter-md q-mb-md"},ln={class:"col-12 col-md-3"},nn={class:"col-12 col-md-3"},on={class:"col-12 col-md-3"},sn={class:"row q-col-gutter-md"},rn={class:"col-12"},dn={class:"row q-col-gutter-md q-mb-md"},un={class:"col-12 col-md-3"},cn={class:"col-12 col-md-3"},mn={class:"col-12 col-md-3"},vn={class:"col-12 col-md-3"},fn={class:"row q-col-gutter-md"},pn={class:"col-12"},gn={class:"row q-col-gutter-md"},yn={class:"col-12 col-md-3"},bn={class:"col-12 col-md-3"},hn={class:"col-12 col-md-3"},In={class:"col-12 col-md-3"},wn={class:"col-12"},Dn={__name:"Finance",setup(e){const t=pe();gt();const o=ge(),r=ye(),u=Be(),m=Je(),_=yt(),g=pt(),y=bt(),d=R("invoices"),n=R(!1),i=R(!1),$=R(!1),I=R(!1),s=R(!1),b=R(!1),V=R(null),M=R(null),N=R(null),w=R(null),x=R(null),C=R(null),J=R({buildingId:"",apartmentId:"",residentId:"",period:{month:new Date().getMonth()+1,year:new Date().getFullYear()},services:{},total:0,status:"pending",date:new Date().toISOString()}),h=R(null),D=R(null),S=R(null),E=R({from:ve.formatDate(new Date().setMonth(new Date().getMonth()-1),"YYYY-MM-DD"),to:ve.formatDate(new Date,"YYYY-MM-DD")}),X=[{label:"Отчет по платежам",value:"payments"},{label:"Отчет по задолженностям",value:"debts"},{label:"Отчет по счетам",value:"invoices"}],_t=[{name:"date",label:"Дата",field:"date",align:"left"},{name:"buildingName",label:"Здание",field:"buildingName",align:"left"},{name:"apartmentNumber",label:"Квартира",field:"apartmentNumber",align:"left"},{name:"residentName",label:"Жилец",field:"residentName",align:"left"},{name:"total",label:"Сумма",field:"total",align:"right"},{name:"status",label:"Статус",field:"status",align:"center"},{name:"actions",label:"Действия",field:"actions",align:"center"}],Vt=[{name:"date",label:"Дата",field:"date",format:l=>z(l)},{name:"building",label:"Здание",field:"buildingId",format:l=>G(l)},{name:"apartment",label:"Квартира",field:"apartmentId",format:l=>te(l)},{name:"resident",label:"Жилец",field:"residentId",format:l=>ae(l)},{name:"amount",label:"Сумма",field:"amount",format:l=>ee(l)},{name:"type",label:"Тип платежа",field:"type"},{name:"status",label:"Статус",field:"status"},{name:"actions",label:"Действия",field:"actions",align:"center"}],$t=[{name:"number",label:"Номер",field:"number"},{name:"date",label:"Дата",field:"date",format:l=>z(l)},{name:"building",label:"Здание",field:"buildingId",format:l=>G(l)},{name:"apartment",label:"Квартира",field:"apartmentId",format:l=>te(l)},{name:"resident",label:"Жилец",field:"residentId",format:l=>ae(l)},{name:"amount",label:"Сумма",field:"amount",format:l=>ee(l)}],Yt=[{name:"building",label:"Здание",field:"buildingId",format:l=>G(l)},{name:"apartment",label:"Квартира",field:"apartmentId",format:l=>te(l)},{name:"resident",label:"Жилец",field:"residentId",format:l=>ae(l)},{name:"amount",label:"Сумма задолженности",field:"amount",format:l=>ee(l)},{name:"dueDate",label:"Срок оплаты",field:"dueDate",format:l=>z(l)},{name:"status",label:"Статус",field:"status"},{name:"actions",label:"Действия",field:"actions",align:"center"}],Ue=Y(()=>t.buildings.map(l=>({label:l.name,value:l.id}))),Te=Y(()=>h.value?o.apartments.filter(l=>l.buildingId===h.value).map(l=>({label:`Квартира ${l.number}`,value:l.id})):[]),Qe=Y(()=>D.value?r.residents.filter(l=>l.apartmentId===D.value).map(l=>({label:`${l.lastName} ${l.firstName}`,value:l.id})):[]),Fe=Y(()=>u.invoices.map(l=>({...l,date:z(l.date),buildingName:G(l.buildingId),apartmentNumber:te(l.apartmentId),residentName:ae(l.residentId),total:ee(l.total),status:be(l.status)}))),He=Y(()=>m.payments.map(l=>({...l,date:z(l.date),buildingName:G(l.buildingId),apartmentNumber:te(l.apartmentId),residentName:ae(l.residentId),amount:ee(l.amount),type:at(l.type),status:be(l.status)}))),Rt=Y(()=>_.receipts.map(l=>({...l,date:z(l.date),buildingName:G(l.buildingId),apartmentNumber:te(l.apartmentId),residentName:ae(l.residentId),amount:ee(l.amount)}))),Ee=Y(()=>g.debts.map(l=>({...l,date:z(l.date),dueDate:z(l.dueDate),buildingName:G(l.buildingId),apartmentNumber:te(l.apartmentId),residentName:ae(l.residentId),amount:ee(l.amount),status:be(l.status)}))),Nt=Y(()=>t.buildings.map(l=>({label:l.name,value:l.id}))),Ut=Y(()=>h.value?o.apartments.filter(l=>l.buildingId===h.value).map(l=>({label:`Квартира ${l.number}`,value:l.id})):[]),kt=Y(()=>D.value?r.residents.filter(l=>l.apartmentId===D.value).map(l=>({label:`${l.lastName} ${l.firstName}`,value:l.id})):[]),ee=l=>new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB"}).format(l),z=l=>new Date(l).toLocaleDateString("ru-RU"),G=l=>{const p=t.buildings.find(c=>c.id===l);return p?p.name:"Неизвестно"},te=l=>{const p=o.apartments.find(c=>c.id===l);return p?p.number:"Неизвестно"},ae=l=>{const p=r.residents.find(c=>c.id===l);return p?`${p.lastName} ${p.firstName}`:"Неизвестно"},be=l=>({pending:"Ожидает оплаты",paid:"Оплачен",overdue:"Просрочен"})[l]||l,at=l=>({utility:"Коммунальные услуги",rent:"Аренда",other:"Прочее"})[l]||l,lt=l=>({pending:"warning",paid:"positive",overdue:"negative"})[l]||"grey",ie=async()=>{try{const l={buildingId:h.value,apartmentId:D.value,residentId:S.value};await u.fetchInvoices(l)}catch(l){console.error("Ошибка при загрузке счетов:",l)}},le=async()=>{try{const l={buildingId:h.value,apartmentId:D.value,residentId:S.value};await m.fetchPayments(l)}catch(l){console.error("Ошибка при загрузке платежей:",l)}},ne=async()=>{try{const l={buildingId:h.value,apartmentId:D.value,residentId:S.value};await _.fetchReceipts(l)}catch(l){console.error("Ошибка при загрузке квитанций:",l)}},oe=async()=>{try{const l={buildingId:h.value,apartmentId:D.value,residentId:S.value};await g.fetchDebts(l)}catch(l){console.error("Ошибка при загрузке долгов:",l)}},he=async l=>{h.value=(l==null?void 0:l.value)||null,D.value=null,S.value=null;try{n.value=!0,await o.fetchApartments({buildingId:h.value}),console.log("Загружено квартир для здания:",o.apartments.length),await Promise.all([ie(),le(),ne(),oe()])}catch(p){console.error("Ошибка при обновлении данных:",p)}finally{n.value=!1}},ke=async l=>{D.value=(l==null?void 0:l.value)||null,S.value=null;try{n.value=!0,await r.fetchResidents({apartmentId:D.value}),console.log("Загружено жильцов для квартиры:",r.residents.length),await Promise.all([ie(),le(),ne(),oe()])}catch(p){console.error("Ошибка при обновлении данных:",p)}finally{n.value=!1}},xe=async l=>{S.value=(l==null?void 0:l.value)||null;try{n.value=!0,await Promise.all([ie(),le(),ne(),oe()])}catch(p){console.error("Ошибка при обновлении данных:",p)}finally{n.value=!1}},xt=()=>{w.value=null,J.value={buildingId:h.value,apartmentId:D.value,residentId:S.value,period:{month:new Date().getMonth()+1,year:new Date().getFullYear()},services:{},total:0,status:"pending",date:new Date().toISOString()},b.value=!0},Ct=async()=>{try{n.value=!0,w.value?await u.updateInvoice(w.value.id,J.value):await u.addInvoice(J.value),b.value=!1,w.value=null,await Promise.all([ie(),le(),ne(),oe()])}catch(l){console.error("Ошибка при сохранении счета:",l)}finally{n.value=!1}},Pt=l=>{w.value=l,J.value={...l},b.value=!0},qt=async l=>{if(confirm("Вы уверены, что хотите удалить этот счет?"))try{await u.deleteInvoice(l),await u.fetchInvoices({buildingId:h.value,apartmentId:D.value,residentId:S.value})}catch(p){console.error("Ошибка при удалении счета:",p)}},Bt=()=>{M.value=null,h.value,D.value,S.value,new Date().toISOString(),i.value=!0},Ot=l=>{M.value=l,i.value=!0},At=()=>{N.value=null,h.value,D.value,S.value,new Date().toISOString(),new Date().toISOString(),I.value=!0},Tt=l=>{N.value=l,I.value=!0},Qt=async()=>{if(V.value)try{const l={buildingId:h.value,apartmentId:D.value,residentId:S.value,startDate:E.value.from,endDate:E.value.to};switch(V.value){case"payments":C.value={title:"Отчет по платежам",data:He.value,total:He.value.reduce((p,c)=>p+c.amount,0)};break;case"debts":C.value={title:"Отчет по задолженностям",data:Ee.value,total:Ee.value.reduce((p,c)=>p+c.amount,0)};break;case"invoices":C.value={title:"Отчет по счетам",data:Fe.value,total:Fe.value.reduce((p,c)=>p+c.total,0)};break}s.value=!0}catch(l){console.error("Ошибка при генерации отчета:",l)}};return re([h,D,S],async()=>{console.log("Изменение фильтров:",{building:h.value,apartment:D.value,resident:S.value}),await Promise.all([ie(),le(),ne(),oe()])},{deep:!0}),Oe(async()=>{try{n.value=!0,await Promise.all([t.fetchBuildings(),y.fetchServices()]),h.value&&await Promise.all([o.fetchApartments({buildingId:h.value}),ie(),le(),ne(),oe()])}catch(l){console.error("Ошибка при инициализации:",l)}finally{n.value=!1}}),(l,p)=>(H(),se("div",Bl,[p[28]||(p[28]=v("h1",null,"Финансовый модуль",-1)),a(ua,{showing:n.value},{default:f(()=>[a(da,{size:"50px",color:"primary"})]),_:1},8,["showing"]),v("div",Ol,[a(sa,{modelValue:d.value,"onUpdate:modelValue":p[0]||(p[0]=c=>d.value=c),class:"text-primary","active-color":"primary","indicator-color":"primary",align:"justify"},{default:f(()=>[a(Se,{name:"invoices",label:"Счета"}),a(Se,{name:"payments",label:"Платежи"}),a(Se,{name:"receipts",label:"Квитанции"}),a(Se,{name:"debts",label:"Задолженности"}),a(Se,{name:"reports",label:"Отчеты"})]),_:1},8,["modelValue"]),a(ra,{modelValue:d.value,"onUpdate:modelValue":p[17]||(p[17]=c=>d.value=c),animated:""},{default:f(()=>[a(Me,{name:"invoices"},{default:f(()=>[v("div",Al,[v("div",Tl,[a(j,null,{default:f(()=>[a(A,null,{default:f(()=>[p[23]||(p[23]=v("div",{class:"text-h6"},"Управление счетами",-1)),v("div",Ql,[v("div",Fl,[a(k,{modelValue:h.value,"onUpdate:modelValue":[p[1]||(p[1]=c=>h.value=c),he],options:Nt.value,label:"Выберите дом","emit-value":"","map-options":""},null,8,["modelValue","options"])]),v("div",Hl,[a(k,{modelValue:D.value,"onUpdate:modelValue":[p[2]||(p[2]=c=>D.value=c),ke],options:Ut.value,label:"Выберите квартиру","emit-value":"","map-options":""},null,8,["modelValue","options"])]),v("div",El,[a(k,{modelValue:S.value,"onUpdate:modelValue":[p[3]||(p[3]=c=>S.value=c),xe],options:kt.value,label:"Выберите жильца","emit-value":"","map-options":""},null,8,["modelValue","options"])]),v("div",zl,[a(q,{color:"primary",label:"Выставить счёт",onClick:xt})])]),h.value?(H(),se("div",Ll,[v("h3",null,"Счета по дому: "+U(G(h.value)),1),a(_e,{rows:Fe.value,columns:_t,"row-key":"id",loading:n.value},{"body-cell-actions":f(c=>[a(O,{props:c},{default:f(()=>[a(q,{flat:"",round:"",color:"primary",icon:"edit",onClick:Ie=>Pt(c.row)},null,8,["onClick"]),a(q,{flat:"",round:"",color:"negative",icon:"delete",onClick:Ie=>qt(c.row.id)},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","loading"])])):Ve("",!0)]),_:1,__:[23]})]),_:1})])])]),_:1}),a(Me,{name:"payments"},{default:f(()=>[v("div",Zl,[v("div",jl,[a(j,null,{default:f(()=>[a(A,null,{default:f(()=>[p[24]||(p[24]=v("div",{class:"text-h6"},"Платежи за коммунальные услуги",-1)),v("div",Xl,[v("div",Kl,[a(k,{modelValue:h.value,"onUpdate:modelValue":[p[4]||(p[4]=c=>h.value=c),he],options:Ue.value,label:"Выберите дом"},null,8,["modelValue","options"])]),v("div",Gl,[a(k,{modelValue:D.value,"onUpdate:modelValue":[p[5]||(p[5]=c=>D.value=c),ke],options:Te.value,label:"Выберите квартиру"},null,8,["modelValue","options"])]),v("div",Wl,[a(k,{modelValue:S.value,"onUpdate:modelValue":[p[6]||(p[6]=c=>S.value=c),xe],options:Qe.value,label:"Выберите жильца"},null,8,["modelValue","options"])]),v("div",Jl,[a(q,{color:"primary",label:"Добавить платеж",onClick:Bt})])]),a(_e,{rows:He.value,columns:Vt,"row-key":"id",loading:nt(m).loading,pagination:{rowsPerPage:10}},{body:f(c=>[a(rt,{props:c},{default:f(()=>[a(O,{key:"date",props:c},{default:f(()=>[P(U(z(c.row.date)),1)]),_:2},1032,["props"]),a(O,{key:"building",props:c},{default:f(()=>[P(U(c.row.buildingName),1)]),_:2},1032,["props"]),a(O,{key:"apartment",props:c},{default:f(()=>[P(U(c.row.apartmentNumber),1)]),_:2},1032,["props"]),a(O,{key:"resident",props:c},{default:f(()=>[P(U(c.row.residentName),1)]),_:2},1032,["props"]),a(O,{key:"amount",props:c},{default:f(()=>[P(U(l.formatCurrency(c.row.amount)),1)]),_:2},1032,["props"]),a(O,{key:"type",props:c},{default:f(()=>[P(U(at(c.row.type)),1)]),_:2},1032,["props"]),a(O,{key:"status",props:c},{default:f(()=>[a(ot,{color:lt(c.row.status),"text-color":"white",size:"sm"},{default:f(()=>[P(U(be(c.row.status)),1)]),_:2},1032,["color"])]),_:2},1032,["props"]),a(O,{key:"actions",props:c},{default:f(()=>[a(st,{flat:""},{default:f(()=>[a(q,{flat:"",round:"",color:"primary",icon:"edit",onClick:Ie=>Ot(c.row)},null,8,["onClick"]),a(q,{flat:"",round:"",color:"negative",icon:"delete",onClick:Ie=>l.confirmDeletePayment(c.row)},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","loading"])]),_:1,__:[24]})]),_:1})])])]),_:1}),a(Me,{name:"receipts"},{default:f(()=>[v("div",en,[v("div",tn,[a(j,null,{default:f(()=>[a(A,null,{default:f(()=>[p[25]||(p[25]=v("div",{class:"text-h6"},"Квитанции об оплате",-1)),v("div",an,[v("div",ln,[a(k,{modelValue:h.value,"onUpdate:modelValue":[p[7]||(p[7]=c=>h.value=c),he],options:Ue.value,label:"Выберите дом"},null,8,["modelValue","options"])]),v("div",nn,[a(k,{modelValue:D.value,"onUpdate:modelValue":[p[8]||(p[8]=c=>D.value=c),ke],options:Te.value,label:"Выберите квартиру"},null,8,["modelValue","options"])]),v("div",on,[a(k,{modelValue:S.value,"onUpdate:modelValue":[p[9]||(p[9]=c=>S.value=c),xe],options:Qe.value,label:"Выберите жильца"},null,8,["modelValue","options"])])]),a(_e,{rows:Rt.value,columns:$t,"row-key":"id",loading:n.value},null,8,["rows","loading"])]),_:1,__:[25]})]),_:1})])])]),_:1}),a(Me,{name:"debts"},{default:f(()=>[v("div",sn,[v("div",rn,[a(j,null,{default:f(()=>[a(A,null,{default:f(()=>[p[26]||(p[26]=v("div",{class:"text-h6"},"Задолженности",-1)),v("div",dn,[v("div",un,[a(k,{modelValue:h.value,"onUpdate:modelValue":[p[10]||(p[10]=c=>h.value=c),he],options:Ue.value,label:"Выберите дом"},null,8,["modelValue","options"])]),v("div",cn,[a(k,{modelValue:D.value,"onUpdate:modelValue":[p[11]||(p[11]=c=>D.value=c),ke],options:Te.value,label:"Выберите квартиру"},null,8,["modelValue","options"])]),v("div",mn,[a(k,{modelValue:S.value,"onUpdate:modelValue":[p[12]||(p[12]=c=>S.value=c),xe],options:Qe.value,label:"Выберите жильца"},null,8,["modelValue","options"])]),v("div",vn,[a(q,{color:"primary",label:"Добавить задолженность",onClick:At})])]),a(_e,{rows:Ee.value,columns:Yt,"row-key":"id",loading:nt(g).loading,pagination:{rowsPerPage:10}},{body:f(c=>[a(rt,{props:c},{default:f(()=>[a(O,{key:"date",props:c},{default:f(()=>[P(U(z(c.row.date)),1)]),_:2},1032,["props"]),a(O,{key:"building",props:c},{default:f(()=>[P(U(c.row.buildingName),1)]),_:2},1032,["props"]),a(O,{key:"apartment",props:c},{default:f(()=>[P(U(c.row.apartmentNumber),1)]),_:2},1032,["props"]),a(O,{key:"resident",props:c},{default:f(()=>[P(U(c.row.residentName),1)]),_:2},1032,["props"]),a(O,{key:"amount",props:c},{default:f(()=>[P(U(l.formatCurrency(c.row.amount)),1)]),_:2},1032,["props"]),a(O,{key:"status",props:c},{default:f(()=>[a(ot,{color:lt(c.row.status),"text-color":"white",size:"sm"},{default:f(()=>[P(U(be(c.row.status)),1)]),_:2},1032,["color"])]),_:2},1032,["props"]),a(O,{key:"actions",props:c},{default:f(()=>[a(st,{flat:""},{default:f(()=>[a(q,{flat:"",round:"",color:"primary",icon:"edit",onClick:Ie=>Tt(c.row)},null,8,["onClick"]),a(q,{flat:"",round:"",color:"negative",icon:"delete",onClick:Ie=>l.confirmDeleteDebt(c.row)},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","loading"])]),_:1,__:[26]})]),_:1})])])]),_:1}),a(Me,{name:"reports"},{default:f(()=>[v("div",fn,[v("div",pn,[a(j,null,{default:f(()=>[a(A,null,{default:f(()=>[p[27]||(p[27]=v("div",{class:"text-h6"},"Финансовые отчеты",-1)),v("div",gn,[v("div",yn,[a(k,{modelValue:h.value,"onUpdate:modelValue":[p[13]||(p[13]=c=>h.value=c),he],options:Ue.value,label:"Выберите дом"},null,8,["modelValue","options"])]),v("div",bn,[a(k,{modelValue:V.value,"onUpdate:modelValue":p[14]||(p[14]=c=>V.value=c),options:X,label:"Тип отчета"},null,8,["modelValue"])]),v("div",hn,[a(T,{modelValue:E.value.from,"onUpdate:modelValue":p[15]||(p[15]=c=>E.value.from=c),type:"date",label:"От"},null,8,["modelValue"])]),v("div",In,[a(T,{modelValue:E.value.to,"onUpdate:modelValue":p[16]||(p[16]=c=>E.value.to=c),type:"date",label:"До"},null,8,["modelValue"])]),v("div",wn,[a(q,{color:"primary",label:"Сформировать отчет",onClick:Qt})])])]),_:1,__:[27]})]),_:1})])])]),_:1})]),_:1},8,["modelValue"])]),a(Ea,{show:i.value,"onUpdate:show":p[18]||(p[18]=c=>i.value=c),"editing-payment":M.value,onSaved:le},null,8,["show","editing-payment"]),a(Ja,{show:$.value,"onUpdate:show":p[19]||(p[19]=c=>$.value=c),payment:x.value,onSaved:ne},null,8,["show","payment"]),a(ul,{show:I.value,"onUpdate:show":p[20]||(p[20]=c=>I.value=c),"editing-debt":N.value,onSaved:oe},null,8,["show","editing-debt"]),a(Dl,{show:s.value,"onUpdate:show":p[21]||(p[21]=c=>s.value=c),"report-data":C.value,"date-range":E.value,"selected-building":h.value,"selected-apartment":D.value,"selected-resident":S.value},null,8,["show","report-data","date-range","selected-building","selected-apartment","selected-resident"]),a(ql,{show:b.value,"onUpdate:show":p[22]||(p[22]=c=>b.value=c),"editing-invoice":w.value,"invoice-form":J.value,onSaved:Ct},null,8,["show","editing-invoice","invoice-form"])]))}},Yn=Ae(Dn,[["__scopeId","data-v-7b50cfa7"]]);export{Yn as default};
