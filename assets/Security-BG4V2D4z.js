import{f as C,g as x,h as i,i as r,Q as c,e as f}from"./QTabPanels-7m-2RM3o.js";import{_ as P,b as k,d as s,e as o,w as t,g as d,o as q,f as B,a4 as m,a5 as u,a8 as I,a6 as L,ad as n}from"./index-94aisbhc.js";const A={name:"SecurityModule",setup(){const b=d("access"),e=d(!1),g=d(null),l=d(null),_=d(null),v=d(null),a=d({twoFactorEnabled:!1,passwordPolicy:!0,sessionTimeout:!0,ipRestriction:!1}),V=[{name:"id",label:"ID",field:"id",sortable:!0},{name:"user",label:"Пользователь",field:"user",sortable:!0},{name:"role",label:"Роль",field:"role",sortable:!0},{name:"assignedAt",label:"Назначена",field:"assignedAt",sortable:!0},{name:"assignedBy",label:"Назначил",field:"assignedBy",sortable:!0}],y=[{name:"id",label:"ID",field:"id",sortable:!0},{name:"timestamp",label:"Время",field:"timestamp",sortable:!0},{name:"type",label:"Тип",field:"type",sortable:!0},{name:"user",label:"Пользователь",field:"user",sortable:!0},{name:"action",label:"Действие",field:"action",sortable:!0},{name:"ip",label:"IP адрес",field:"ip",sortable:!0}],p=[{label:"Администратор",value:"admin"},{label:"Менеджер",value:"manager"},{label:"Оператор",value:"operator"},{label:"Просмотр",value:"viewer"}],w=[{label:"Все события",value:"all"},{label:"Вход в систему",value:"login"},{label:"Изменение прав",value:"permissions"},{label:"Настройки безопасности",value:"settings"}],T=d([]),U=d([]),Q=d([]),R=()=>{};return q(()=>{}),{activeTab:b,loading:e,selectedRole:g,selectedUser:l,selectedLogType:_,dateRange:v,settings:a,roleColumns:V,logColumns:y,roles:p,logTypes:w,users:T,roleAssignments:U,securityLogs:Q,assignRole:R}}},E={class:"security-module"},S={class:"security-tabs"},F={class:"row q-col-gutter-md"},D={class:"col-12"},M={class:"row q-col-gutter-md"},N={class:"col-12 col-md-4"},j={class:"col-12 col-md-4"},z={class:"col-12 col-md-4"},G={class:"row q-col-gutter-md"},H={class:"col-12"},J={class:"row q-col-gutter-md"},K={class:"col-12 col-md-4"},O={class:"col-12 col-md-4"},W={class:"row q-col-gutter-md"},X={class:"col-12"},Y={class:"row q-col-gutter-md"},Z={class:"col-12 col-md-6"},h={class:"col-12 col-md-6"},$={class:"col-12 col-md-6"},ll={class:"col-12 col-md-6"};function el(b,e,g,l,_,v){return B(),k("div",E,[e[13]||(e[13]=s("h1",null,"Безопасность",-1)),s("div",S,[o(C,{modelValue:l.activeTab,"onUpdate:modelValue":e[0]||(e[0]=a=>l.activeTab=a),class:"text-primary","active-color":"primary","indicator-color":"primary",align:"justify"},{default:t(()=>[o(i,{name:"access",label:"Управление доступом"}),o(i,{name:"logs",label:"Журнал событий"}),o(i,{name:"settings",label:"Настройки безопасности"})]),_:1},8,["modelValue"]),o(x,{modelValue:l.activeTab,"onUpdate:modelValue":e[9]||(e[9]=a=>l.activeTab=a),animated:""},{default:t(()=>[o(r,{name:"access"},{default:t(()=>[s("div",F,[s("div",D,[o(m,null,{default:t(()=>[o(u,null,{default:t(()=>[e[10]||(e[10]=s("div",{class:"text-h6"},"Роли и права доступа",-1)),s("div",M,[s("div",N,[o(c,{modelValue:l.selectedRole,"onUpdate:modelValue":e[1]||(e[1]=a=>l.selectedRole=a),options:l.roles,label:"Роль"},null,8,["modelValue","options"])]),s("div",j,[o(c,{modelValue:l.selectedUser,"onUpdate:modelValue":e[2]||(e[2]=a=>l.selectedUser=a),options:l.users,label:"Пользователь"},null,8,["modelValue","options"])]),s("div",z,[o(I,{color:"primary",label:"Назначить роль",onClick:l.assignRole},null,8,["onClick"])])]),o(f,{rows:l.roleAssignments,columns:l.roleColumns,"row-key":"id",loading:l.loading},null,8,["rows","columns","loading"])]),_:1,__:[10]})]),_:1})])])]),_:1}),o(r,{name:"logs"},{default:t(()=>[s("div",G,[s("div",H,[o(m,null,{default:t(()=>[o(u,null,{default:t(()=>[e[11]||(e[11]=s("div",{class:"text-h6"},"Журнал событий безопасности",-1)),s("div",J,[s("div",K,[o(c,{modelValue:l.selectedLogType,"onUpdate:modelValue":e[3]||(e[3]=a=>l.selectedLogType=a),options:l.logTypes,label:"Тип события"},null,8,["modelValue","options"])]),s("div",O,[o(L,{modelValue:l.dateRange,"onUpdate:modelValue":e[4]||(e[4]=a=>l.dateRange=a),type:"daterange",label:"Период"},null,8,["modelValue"])])]),o(f,{rows:l.securityLogs,columns:l.logColumns,"row-key":"id",loading:l.loading},null,8,["rows","columns","loading"])]),_:1,__:[11]})]),_:1})])])]),_:1}),o(r,{name:"settings"},{default:t(()=>[s("div",W,[s("div",X,[o(m,null,{default:t(()=>[o(u,null,{default:t(()=>[e[12]||(e[12]=s("div",{class:"text-h6"},"Настройки безопасности",-1)),s("div",Y,[s("div",Z,[o(n,{modelValue:l.settings.twoFactorEnabled,"onUpdate:modelValue":e[5]||(e[5]=a=>l.settings.twoFactorEnabled=a),label:"Двухфакторная аутентификация"},null,8,["modelValue"])]),s("div",h,[o(n,{modelValue:l.settings.passwordPolicy,"onUpdate:modelValue":e[6]||(e[6]=a=>l.settings.passwordPolicy=a),label:"Строгая политика паролей"},null,8,["modelValue"])]),s("div",$,[o(n,{modelValue:l.settings.sessionTimeout,"onUpdate:modelValue":e[7]||(e[7]=a=>l.settings.sessionTimeout=a),label:"Автоматический выход"},null,8,["modelValue"])]),s("div",ll,[o(n,{modelValue:l.settings.ipRestriction,"onUpdate:modelValue":e[8]||(e[8]=a=>l.settings.ipRestriction=a),label:"Ограничение по IP"},null,8,["modelValue"])])])]),_:1,__:[12]})]),_:1})])])]),_:1})]),_:1},8,["modelValue"])])])}const al=P(A,[["render",el],["__scopeId","data-v-317498cf"]]);export{al as default};
